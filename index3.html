<!doctype html>
<html>
<head>
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.js"></script>
  <script src="src/timble.js"></script>
</head>
<body>
 



<script>

(function() { 
  var moursOsc;
  var mmoursEnv;
  
  
  //
  // setup関数
  //
  function timbleInit() {

    moursOsc = T("tri", {freq: mtof(airNoteMelody()), mul:0.5});
    var moursFilter = T("lpf" , {cutoff:100 + (Math.random()*100), Q:12}, moursOsc)
    mmoursEnv =  T("env", {table: [0.8, [0.8, 100],[0, 5]]}, moursFilter).bang();
    mmoursEnv.play();
    
  }


  function  airNoteMelody() {
    return Math.floor(Math.random()*15 + 7) * 5
  }

  function mtof(val) {
    return Math.floor(440*Math.pow(2, (val-69)/12));
  }


  timbleInit();

  

  setInterval( function() {    
    if(Math.floor(Math.random()*3) % 3 == 0) {
      moursOsc.freq.value = mtof(airNoteMelody());
      mmoursEnv.bang().play();
    }
  }, 50);


})();
 
</script>
 
</body>
</html>